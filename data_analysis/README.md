# Generating figures
This directory includes all of the data and code to replicate the figures presented in Martin & Koelle 2021 which is a Technical Comment in response to Popa & Genger et al. Science Translational Medicine 2020. This directory includes the following scripts:

```
format_metadata.py
```
This is a fairly simply Python3 script which formats the various supplementary metadata files from Popa & Genger et al. into a single csv file. It is set up to be run from this directory (`sarscov2_nb_reanalysis/figures`) and expects the `data/abe2555_Data_file_S1_SampleInformation.csv`, `'data/abe2555_Data_file_S5.csv`, and `data/abe2555_Data_file_S4.csv` files as input (available at https://stm.sciencemag.org/content/12/573/eabe2555/tab-figures-data) and requires Pandas to be installed. PLEASE NOTE: Sample CoV_159 does not have a family labelled in abe2555_Data_file_S4, HOWEVER, based on Fig. 5A and Fig. 5B in Popa & Genger et al. we have assumed that this patient belongs to Family 11. 

```
plot_figues.py
```
This is a Python3 script which is responsible for generating all of the figures. It requires the following files as input:
* `data/abe255_Data_file_format.csv` as generated by the `format_metadata.py` file
* VCF files with variants called relative to wuhan in the `data/seq/*/*_filter_norm.vcf` path where `*` is the sample name (e.g. `CoV_041_S63682_sorted_viral_rh`)
* VCF files with variant calles realtive to the donor sequence in the `data/seq_realign/*-@/@_filter_norm.vcf` path where `*` is the sample name and `@` is the sample name of the donor for that transmission pair. 
